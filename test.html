<html>
<head>
	<title>测试页面</title>
	<meta name="viewport" id="viewport" content="width=device-width,maximum-scale=3.0" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

	<script src="https://cdn.staticfile.org/jquery/1.10.2/jquery.min.js"></script>

	<script type="text/javascript">

		function test() {
			alert("id: test 3333333" );
		}


		function goback() {
			if (window.webview != null) {
				window.webview.goback();
			} else {
				window.webkit && window.webkit.messageHandlers && window.webkit.messageHandlers.goback && window.webkit.messageHandlers.goback.postMessage(null);
			}
			
		}

		function closeWindow() {
			if (window.webview != null) {
				window.webview.closeWindow();
			} else {
				window.webkit && window.webkit.messageHandlers && window.webkit.messageHandlers.closeWindow && window.webkit.messageHandlers.closeWindow.postMessage(null);
			}
		}

		function openNewWindow() {
			if (window.webview != null) {
				window.webview.openNewWindow(window.location.href);
			} else {
				window.webkit && window.webkit.messageHandlers && window.webkit.messageHandlers.openNewWindow && window.webkit.messageHandlers.openNewWindow.postMessage(window.location.href);
			}
		}

		function openNewWindow2() {
			if (window.webview != null) {
				window.webview.openNewWindow('https://www.baidu.com');
			} else {
				window.webkit && window.webkit.messageHandlers && window.webkit.messageHandlers.openNewWindow && window.webkit.messageHandlers.openNewWindow.postMessage('https://www.baidu.com');
			}
		}

		// function addLocalStorage() {

		// 	var data = prompt("localStorage account 信息","yellow");
		// 	if (window.webview != null) {

		// 	} else {
		// 		if (data != null) {
		// 			window.webkit && window.webkit.messageHandlers && window.webkit.messageHandlers.saveLocalStorage && window.webkit.messageHandlers.saveLocalStorage.postMessage({account:data,token:"----- "+data+" -----"});
		// 		}
		// 	}
			
		// }

		function share() 
		{
			var title = "微信分享";
			var content = "1234567";
			var url = 'https://www.baidu.com';
			var callback = "shareResult";

			var info = {title:title,content:content,url:url,callback:callback};
			if (window.webview != null) {
				window.webview.share(JSON.stringify(info));
			} else {
				 window.webkit && window.webkit.messageHandlers && window.webkit.messageHandlers.share && window.webkit.messageHandlers.share.postMessage(JSON.stringify(info));
			}

		}

		function shareResult(r)
		{
			var d = JSON.parse(r);
			if (d.code == 1) {
				alert('分享结果：' + d.app + ' 成功');
			} else {
				alert('分享结果：' + d.app + ' 失败');
			}
			
		}

		function getTokenFun() 
		{
			var info = {callback:"fetchToken"};
			if (window.webview != null) {
				window.webview.getToken(JSON.stringify(info));
			} else {
				window.webkit && window.webkit.messageHandlers && window.webkit.messageHandlers.getToken && window.webkit.messageHandlers.getToken.postMessage(JSON.stringify(info));
			}

		}

		function fetchToken(r) 
		{
			alert('用户信息：' + r + ' 成功');
		}

		function logout() 
		{
			if (window.webview != null) {
				window.webview.logout();
			} else {
				 window.webkit && window.webkit.messageHandlers && window.webkit.messageHandlers.logout && window.webkit.messageHandlers.logout.postMessage(null);
			}
		}

		var refreshNumber=0;
		function viewWillAppear()
		{
			document.getElementById('refreshlabel').innerHTML = ++refreshNumber;
			console.log('即将显示该页面，可以进行刷新操作');
		}

		function viewWillDisappear()
		{
			console.log('即将隐藏该页面，保存数据操作');
		}

		$(document).ready(function(){
			document.getElementById('datetime').innerHTML = new Date().toLocaleString();
			document.getElementById('currenttime').innerHTML = new Date().toLocaleString();
			setInterval("document.getElementById('currenttime').innerHTML=new Date().toLocaleString();", 1000);

		  	var nodes = document.getElementsByTagName('button');
			for (var i = 0; i < nodes.length; i++) {
				(function(i) {
					var id = nodes[i].id;
					nodes[i].onclick = function()
					{
						try {
							window[id]();
						} catch (error) {
							alert("没有找到 function " + id + "() { ... } 函数");
						}
						
					}
				})(i);
			}
		});

		
	</script>
	<style type="text/css">

		button {
			border-width: 3;
		    max-width: 200px;
		    min-height: 50px;
		    color: #FFEB3B;
		    margin: 10;
		    background: gray;
		    border: 2px solid #a1a1a1;
		    border-radius: 25px;
		    font-size: 20;
		}

	</style>
</head>
<body>
	<div align="center">
		<h1  >H5 交互测试</h1>
		<div style="display: flex;">
			<h3 id="datetime" ></h3>
			<h3 id="currenttime" style="color: lightgray;"></h3>

		</div>
		刷新次数：
		<h3 id="refreshlabel" style="color: lightgray;"></h3>
		
		<div style="display: flex;">
			<h2>用户信息：</h2>
			<h2 id="token">
			<script >
				document.getElementById('token').innerHTML = localStorage.getItem("account");;
			</script>
		</h2>
		</div>
	</div>
	
	

	<div style="justify-content: center;display: grid;">
		<button id="test">Click Me!</button>
		<button id="goback">返回</button>
		<button id="closeWindow">退出窗口</button>
		<button id="openNewWindow">打开新的窗口</button>
		<button id="openNewWindow2">百度一下</button>
		<!-- <button id="addLocalStorage">写数据</button> -->
		<button id="share">分享</button>
		<button id="getTokenFun">获取用户信息</button>
		<button id="logout">退出登录</button>
		<a href="test.html"> test.html </a>
	</div>
	

	<div style="height: 300px">
		
	</div>


</body>
</html>
